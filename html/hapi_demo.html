
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>hapi_demo</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-06-20"><meta name="DC.source" content="hapi_demo.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Download hapi.m if not found.</a></li><li><a href="#2">Scalar ephemeris from SSCWeb</a></li><li><a href="#3">Two scalars from SSCWeb</a></li><li><a href="#4">Scalar string from SSCWeb</a></li><li><a href="#5">Vector from CDAWeb</a></li><li><a href="#6">Jeremy's garage temperatures</a></li><li><a href="#7">Spectra from CASSINIA S/C</a></li><li><a href="#8">Test Data: Vector (size = [3] in HAPI notation)</a></li><li><a href="#9">Test Data: 10-element vector (size = [10] in HAPI notation)</a></li><li><a href="#10">Test Data: 3x3 transformation matrix as 1-D HAPI array</a></li><li><a href="#11">Test Data: 3x3 transformation matrix as 2-D HAPI array</a></li><li><a href="#12">Test Data: Scalar string parameter</a></li><li><a href="#13">Test Data: Scalar isotime parameter</a></li><li><a href="#14">Test Data: Scalar integer parameter (with proposed category map)</a></li><li><a href="#15">Test Data: Parameter that is two vectors</a></li><li><a href="#16">Test Data: Vector of strings</a></li><li><a href="#17">Test Data: 100-element time series with no bins</a></li><li><a href="#18">Test Data: All parameters</a></li><li><a href="#19">Request list of known HAPI servers</a></li><li><a href="#20">List datasets from a server</a></li><li><a href="#21">Get metadata for all parameters in a dataset</a></li><li><a href="#22">Get parameter metadata for one parameter in a dataset</a></li></ul></div><h2>Download hapi.m if not found.<a name="1"></a></h2><pre class="codeinput"><span class="keyword">if</span> exist(<span class="string">'hapi'</span>,<span class="string">'file'</span>) ~= 2
    u = <span class="string">'https://raw.githubusercontent.com/hapi-server/matlab-client/master/hapi.m'</span>;
    urlwrite(u,<span class="string">'hapi.m'</span>);
<span class="keyword">end</span>
</pre><h2>Scalar ephemeris from SSCWeb<a name="2"></a></h2><pre class="codeinput">server     = <span class="string">'http://tsds.org/get/SSCWeb/hapi'</span>;
dataset    = <span class="string">'ace'</span>;
parameters = <span class="string">'X_TOD'</span>;
start      = <span class="string">'2012-02-01'</span>;
stop       = <span class="string">'2012-02-02'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

<span class="comment">% Get data and metadata</span>
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
</pre><pre class="codeoutput">Reading hapi-data/tsds.org_get_SSCWeb_hapi/ace_X_TOD_20120201_20120202.mat ... Done.

data = 

              Time: [120x24 char]
    DateTimeVector: [120x7 int32]
             X_TOD: [120x1 double]


meta = 

       startDate: '1997-08-25T17:48:00Z'
        stopDate: '2017-08-27T23:36:00Z'
         cadence: 'PT720S'
    creationDate: '2017-06-18T22:48:57.964Z'
            HAPI: '1.1'
          status: [1x1 struct]
      parameters: {2x1 cell}
              x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
    length: 25


ans = 

           name: 'X_TOD'
           type: 'double'
          units: 'R_E'
    description: 'X Position in the Geocentric Equatorial Inertial coordin...'
           fill: '1e31'

hapiplot.m: Wrote ./hapi-figures/ace_X_TOD_20120201_20120202.png
</pre><img vspace="5" hspace="5" src="hapi_demo_01.png" alt=""> <h2>Two scalars from SSCWeb<a name="3"></a></h2><pre class="codeinput">server     = <span class="string">'http://tsds.org/get/SSCWeb/hapi'</span>;
dataset    = <span class="string">'ace'</span>;
parameters = <span class="string">'X_TOD,Y_TOD'</span>;
start      = <span class="string">'2012-02-01'</span>;
stop       = <span class="string">'2012-02-02'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

<span class="comment">% Get data and metadata</span>
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
</pre><pre class="codeoutput">Reading hapi-data/tsds.org_get_SSCWeb_hapi/ace_X_TOD-Y_TOD_20120201_20120202.mat ... Done.

data = 

              Time: [120x24 char]
    DateTimeVector: [120x7 int32]
             X_TOD: [120x1 double]
             Y_TOD: [120x1 double]


meta = 

       startDate: '1997-08-25T17:48:00Z'
        stopDate: '2017-08-27T23:36:00Z'
         cadence: 'PT720S'
    creationDate: '2017-06-18T22:49:01.673Z'
            HAPI: '1.1'
          status: [1x1 struct]
      parameters: {3x1 cell}
              x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
    length: 25


ans = 

           name: 'X_TOD'
           type: 'double'
          units: 'R_E'
    description: 'X Position in the Geocentric Equatorial Inertial coordin...'
           fill: '1e31'


ans = 

           name: 'Y_TOD'
           type: 'double'
          units: 'R_E'
    description: 'Y Position in the Geocentric Equatorial Inertial coordin...'
           fill: '1e31'

hapiplot.m: Wrote ./hapi-figures/ace_X_TOD_20120201_20120202.png
hapiplot.m: Wrote ./hapi-figures/ace_Y_TOD_20120201_20120202.png
</pre><img vspace="5" hspace="5" src="hapi_demo_02.png" alt=""> <img vspace="5" hspace="5" src="hapi_demo_03.png" alt=""> <h2>Scalar string from SSCWeb<a name="4"></a></h2><pre class="codeinput">server     = <span class="string">'http://tsds.org/get/SSCWeb/hapi'</span>;
dataset    = <span class="string">'ace'</span>;
parameters = <span class="string">'LT_GEO'</span>;
start      = <span class="string">'2012-02-01'</span>;
stop       = <span class="string">'2012-02-02'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

<span class="comment">% Get data and metadata</span>
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
</pre><pre class="codeoutput">Reading hapi-data/tsds.org_get_SSCWeb_hapi/ace_LT_GEO_20120201_20120202.mat ... Done.

data = 

              Time: [120x24 char]
    DateTimeVector: [120x7 int32]
            LT_GEO: {[120x8 char]}


meta = 

       startDate: '1997-08-25T17:48:00Z'
        stopDate: '2017-08-27T23:36:00Z'
         cadence: 'PT720S'
    creationDate: '2017-06-18T22:49:05.889Z'
            HAPI: '1.1'
          status: [1x1 struct]
      parameters: {2x1 cell}
              x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
    length: 25


ans = 

           name: 'LT_GEO'
           type: 'string'
          units: '$H:$M:$S'
    description: 'Local time in the Geographic coordinate system, also kno...'
           fill: '99:99:99'
         length: 9

hapiplot.m: Wrote ./hapi-figures/ace_LT_GEO(:,1)_20120201_20120202.png
</pre><img vspace="5" hspace="5" src="hapi_demo_04.png" alt=""> <h2>Vector from CDAWeb<a name="5"></a></h2><p>Had to modify hapi.m to work because /info?id=AC_H0_MFI&amp;parameters=BGSEc returns all parameters, not just BGSEc. Also note the metadata has the wrong fill value of "-9.999999848243207E30".  It should be "-1e31" and a correction was applied below.</p><pre class="codeinput">server     = <span class="string">'https://voyager.gsfc.nasa.gov/hapiproto/hapi'</span>;
dataset    = <span class="string">'AC_H0_MFI'</span>;
parameters = <span class="string">'BGSEc'</span>;
start      = <span class="string">'2002-01-01'</span>;
stop       = <span class="string">'2002-01-02'</span>;
opts       = struct(<span class="string">'logging'</span>,1,<span class="string">'use_cache'</span>,0);

<span class="comment">% Get data and metadata</span>
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

meta.parameters{2}.fill = <span class="string">'-1e31'</span>; <span class="comment">% Correct fill value.</span>
<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}
meta.parameters{1}.name = <span class="string">'Time'</span>; <span class="comment">% Fix error in metadata.</span>
<span class="comment">% Plot</span>
hapiplot(data,meta)
</pre><pre class="codeoutput">Downloading https://voyager.gsfc.nasa.gov/hapiproto/hapi/info?id=AC_H0_MFI&amp;parameters=BGSEc ... Warning: Server returned too many parameters in
/info request 
Done.
Wrote hapi-data/voyager.gsfc.nasa.gov_hapiproto_hapi/AC_H0_MFI_BGSEc.json ...
Downloading https://voyager.gsfc.nasa.gov/hapiproto/hapi/data?id=AC_H0_MFI&amp;time.min=2002-01-01&amp;time.max=2002-01-02&amp;parameters=BGSEc ... Done.
Reading hapi-data/voyager.gsfc.nasa.gov_hapiproto_hapi/AC_H0_MFI_BGSEc_20020101_20020102.csv ... Done.
Parsing hapi-data/voyager.gsfc.nasa.gov_hapiproto_hapi/AC_H0_MFI_BGSEc_20020101_20020102.csv ... Done.
Saving hapi-data/voyager.gsfc.nasa.gov_hapiproto_hapi/AC_H0_MFI_BGSEc_20020101_20020102.mat ... Done.

data = 

              Time: [5400x23 char]
    DateTimeVector: [5400x7 int32]
             BGSEc: [5400x3 double]


meta = 

            HAPI: '1.0'
    creationDate: '2017/06/20 15:38:28'
      parameters: {[1x1 struct]  [1x1 struct]}
       startDate: '1997-09-02T00:00:12'
        stopDate: '2017-04-11T23:59:53'
              x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
    length: 24


ans = 

           name: 'BGSEc'
           type: 'double'
          units: 'nT'
           fill: '-1e31'
    description: 'Magnetic Field Vector in GSE Cartesian coordinates (16 sec)'
           size: 3

hapiplot.m: Wrote ./hapi-figures/AC_H0_MFI_BGSEc_20020101_20020102.png
</pre><img vspace="5" hspace="5" src="hapi_demo_05.png" alt=""> <h2>Jeremy's garage temperatures<a name="6"></a></h2><p>He is what we call, euphemistically, 'Temperature involved'. Note that hapi.m needed to allow 'float' as a data type for this to work.</p><pre class="codeinput">server     = <span class="string">'http://jfaden.net/HapiServerDemo/hapi'</span>;
dataset    = <span class="string">'0B000800408DD710'</span>;
parameters = <span class="string">''</span>;
start      = <span class="string">'2017-06-17T21:20:32.052'</span>;
stop       = <span class="string">'2017-06-18T21:20:32.520'</span>;
opts       = struct(<span class="string">'logging'</span>,1,<span class="string">'use_cache'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'0B000800408DD710')</span>
</pre><pre class="codeoutput">Reading hapi-data/jfaden.net_HapiServerDemo_hapi/0B000800408DD710__20170617T21:20:32.052_20170618T212032520.mat ... Done.

data = 

              Time: [4575x23 char]
    DateTimeVector: [4209x7 int32]
       Temperature: [4209x1 double]


meta = 

               HAPI: '1.1'
          createdAt: '2017-06-18T22:10Z'
         parameters: {2x1 cell}
    sampleStartDate: '2017-06-17T22:10:44.004Z'
     sampleStopDate: '2017-06-18T22:10:44.044Z'
          startDate: '2012-01-09T00:00:00.000Z'
             status: [1x1 struct]
           stopDate: '2017-06-18T22:10:44.044Z'
                 x_: [1x1 struct]

meta.parameters = 
ans = 

    length: 24
      name: 'Time'
      type: 'isotime'
     units: 'UTC'


ans = 

    description: 'temperature in garage, car'
           fill: '-1e31'
           name: 'Temperature'
           type: 'float'
          units: 'deg F'

hapiplot.m: Wrote ./hapi-figures/0B000800408DD710_Temperature_20170617T21:20:32.052_20170618T212032520.png
</pre><img vspace="5" hspace="5" src="hapi_demo_06.png" alt=""> <h2>Spectra from CASSINIA S/C<a name="7"></a></h2><p>HAPIPLOT infers that this should be plotted as a spectra because bins metadata were provided. Note that the first parameter is named time_array_0 instead of Time. To allow HAPIPLOT to work, this parameter was renamed before HAPIPLOT was called.  This parameter would have been plotted with log_{10} z-axis automatically by HAPIPLOT because the distribution of values is heavy-tailed, but there were negative values, which are not expected given the units are particles/sec/cm^2/ster/keV.</p><pre class="codeinput">server     = <span class="string">'http://datashop.elasticbeanstalk.com/hapi'</span>;
dataset    = <span class="string">'CASSINI_LEMMS_PHA_CHANNEL_1_SEC'</span>;
parameters = <span class="string">'A'</span>;
start      = <span class="string">'2002-01-01'</span>;
stop       = <span class="string">'2002-01-02T00:06:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

<span class="comment">% Get data and metadata</span>
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}
meta.parameters{1}.name = <span class="string">'Time'</span>; <span class="comment">% Fix error in metadata.</span>
<span class="comment">% Plot</span>
hapiplot(data,meta)
</pre><pre class="codeoutput">Reading hapi-data/datashop.elasticbeanstalk.com_hapi/CASSINI_LEMMS_PHA_CHANNEL_1_SEC_A_20020101_20020102T000600.mat ... Done.

data = 

              Time: [8037x23 char]
    DateTimeVector: [8037x7 int32]
                 A: [8037x55 double]


meta = 

               HAPI: '1.1'
             status: [1x1 struct]
         parameters: {2x1 cell}
          startDate: '2002-01-01T00:00:00.000'
           stopDate: '2016-05-12T21:38:16.000'
    sampleStartDate: '2002-01-02T00:00:00.000'
      sampleEndDate: '2002-01-02T06:00:00.000'
        description: 'Cassini MIMI LEMMS PHA channel intensities with mag ...'
       creationDate: '2017-06-18T22:49:22.000'
            cadence: 'PT1S'
                 x_: [1x1 struct]

meta.parameters = 
ans = 

           name: 'time_array_0'
           type: 'isotime'
         length: 23
          units: 'UTC'
           fill: []
    description: 'time as UTC string to milliseconds'


ans = 

           name: 'A'
           type: 'double'
          units: 'particles/sec/cm^2/ster/keV'
           size: 55
           fill: '-1.0e38'
    description: 'high energy resolution LEMMS spectrum of A channels'
           bins: [1x1 struct]

Warning: Parameter has bin ranges, but hapi_plot
will not use them. 
hapiplot.m: Wrote ./hapi-figures/CASSINI_LEMMS_PHA_CHANNEL_1_SEC_A_20020101_20020102T000600.png
</pre><img vspace="5" hspace="5" src="hapi_demo_07.png" alt=""> <h2>Test Data: Vector (size = [3] in HAPI notation)<a name="8"></a></h2><p>HAPIPLOT infers that this a parameter that should be displayed as multiple time series because the number of components of the vector is &lt; 10. Note that the metadata does not provide labels for the individual components of the vector, so "Column #" is used in the legend. HAPI metadata should include an option to add column labels.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'vector'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'vector')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_vector_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
            vector: [60x3 double]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'vector'
           type: 'double'
          units: 'm'
           fill: '-1e31'
           size: 3
    description: 'Each component is a sine wave with a 600 s period with d...'

hapiplot.m: Wrote ./hapi-figures/dataset1_vector_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_08.png" alt=""> <h2>Test Data: 10-element vector (size = [10] in HAPI notation)<a name="9"></a></h2><p>HAPIPLOT infers that this a parameter that should be displayed as a spectra because the number of vector elements is &gt; 9. Note that the metadata does not provide labels for the individual components of the vector, so "Column" is used as the y-axis label.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'vector'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'vector')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_vector_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
            vector: [60x3 double]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'vector'
           type: 'double'
          units: 'm'
           fill: '-1e31'
           size: 3
    description: 'Each component is a sine wave with a 600 s period with d...'

hapiplot.m: Wrote ./hapi-figures/dataset1_vector_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_09.png" alt=""> <h2>Test Data: 3x3 transformation matrix as 1-D HAPI array<a name="10"></a></h2><p>HAPIPLOT infers that this a parameter that should be displayed as a spectra because the number of components is &gt;= 9. Note that the metadata does not provide bins so the y-labels are "Column #'.  In this case the data provider indented to provide a time series of rotation transformation matrices  (using Javascript array notation) [Txx, Txy, Txz, Tyx, Tyy, Tyz, Tzx, Tzy, Tzz]. HAPI metadata should include the ability to provide these labels.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'transform'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'transform')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_transform_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
         transform: [60x9 double]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'transform'
           type: 'double'
          units: 'm'
           fill: '-1e31'
           size: 9
    description: 'Transformation matrix elements Txx, Txy, Txz, Tyx, Tyy, ...'

hapiplot.m: Wrote ./hapi-figures/dataset1_transform_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_10.png" alt=""> <h2>Test Data: 3x3 transformation matrix as 2-D HAPI array<a name="11"></a></h2><p>HAPIPLOT displays each layer of the matrix as three time series with y-labels tranformmulti(:,:,1), transformmulti(:,:,2), and transformmulti(:,:,3) and legend labels of "Column #", where # = 1, 2, or 3. In this case the data provided intended to provided a time series of rotation matrices with labels (using HAPI array notation) [['Txx','Txy','Txz'],['Tyx','Tyy','Tyz'],['Tzx','Tzy','Tzz']]. HAPI should include the ability to provide these labels.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'transformmulti'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

<span class="comment">% Plot</span>
hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'transformulti')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_transformmulti_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
    transformmulti: [60x3x3 double]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'transformmulti'
           type: 'double'
          units: 'm'
           fill: '-1e31'
           size: [2x1 double]
    description: '3-D transformation matrix'

hapiplot.m: Wrote ./hapi-figures/dataset1_transformmulti(:,:,1)_19700101_19700101T000100.png
hapiplot.m: Wrote ./hapi-figures/dataset1_transformmulti(:,:,2)_19700101_19700101T000100.png
hapiplot.m: Wrote ./hapi-figures/dataset1_transformmulti(:,:,3)_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_11.png" alt=""> <img vspace="5" hspace="5" src="hapi_demo_12.png" alt=""> <img vspace="5" hspace="5" src="hapi_demo_13.png" alt=""> <h2>Test Data: Scalar string parameter<a name="12"></a></h2><p>Demonstrating how HAPIPLOT handles this type of parameter.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'scalarstr'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'scalarstr')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_scalarstr_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
         scalarstr: {[60x3 char]}


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'scalarstr'
           type: 'string'
          units: []
           fill: []
         length: 4
    description: 'Status checks result; P = Pass, F = Fail'

hapiplot.m: Wrote ./hapi-figures/dataset1_scalarstr(:,1)_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_14.png" alt=""> <h2>Test Data: Scalar isotime parameter<a name="13"></a></h2><p>HAPIPLOT converts the isotime string to a MATLAB DATENUM to create y-axis labels.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'scalariso'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'scalariso')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_scalariso_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
         scalariso: {[60x20 char]}


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'scalariso'
           type: 'isotime'
          units: 'UTC'
           fill: '0000-00-00:T00:00:00Z'
         length: 21
    description: 'Time parameter + 1 second'

hapiplot.m: Wrote ./hapi-figures/dataset1_scalariso(:,1)_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_15.png" alt=""> <h2>Test Data: Scalar integer parameter (with proposed category map)<a name="14"></a></h2><p>A time series of integers intended to communicate a status represented by a string.  The metadata includes a (non-HAPI standard) map from an integer to a string, and this map is used to generate y-axis labels.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'scalarcats'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'scalarcats')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_scalarcats_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
        scalarcats: [60x1 int32]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'scalarcats'
           type: 'integer'
          units: []
           fill: []
    categorymap: [1x1 struct]
    description: 'Category of personality'

hapiplot.m: Wrote ./hapi-figures/dataset1_scalarcats_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_16.png" alt=""> <h2>Test Data: Parameter that is two vectors<a name="15"></a></h2><p>HAPIPLOT creates two time series plots in this case and labels the first using MATLAB notation as vectormulti(:,:,1) and second as vectormulti(:,:,2).</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>; ;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'vectormulti'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'vectormulti')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_vectormulti_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
       vectormulti: [60x3x2 double]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'vectormulti'
           type: 'double'
          units: 'm'
           fill: '-1e31'
           size: [2x1 double]
    description: 'Two vectors; Each component of each vector is a sine wav...'

hapiplot.m: Wrote ./hapi-figures/dataset1_vectormulti(:,:,1)_19700101_19700101T000100.png
hapiplot.m: Wrote ./hapi-figures/dataset1_vectormulti(:,:,2)_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_17.png" alt=""> <img vspace="5" hspace="5" src="hapi_demo_18.png" alt=""> <h2>Test Data: Vector of strings<a name="16"></a></h2><p>In this unusual dataset, 3-vector (size = [3] in HAPI notation) of strings is given. HAPIPLOT creates three time series plots, one for each vector component.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'vectorstr'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'vectorstr')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_vectorstr_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
         vectorstr: {[60x3 char]  [60x3 char]  [60x3 char]}


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'vectorstr'
           type: 'string'
          units: []
           fill: []
         length: 4
           size: 3
    description: 'Status checks result; P = Pass, F = Fail'

hapiplot.m: Wrote ./hapi-figures/dataset1_vectorstr(:,1)_19700101_19700101T000100.png
hapiplot.m: Wrote ./hapi-figures/dataset1_vectorstr(:,2)_19700101_19700101T000100.png
hapiplot.m: Wrote ./hapi-figures/dataset1_vectorstr(:,3)_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_19.png" alt=""> <img vspace="5" hspace="5" src="hapi_demo_20.png" alt=""> <img vspace="5" hspace="5" src="hapi_demo_21.png" alt=""> <h2>Test Data: 100-element time series with no bins<a name="17"></a></h2><p>HAPIPLOT assumes that this is best plotted as a spectra because the number of elements is greater than 9.</p><pre class="codeinput">server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>;
dataset    = <span class="string">'dataset1'</span>;
parameters = <span class="string">'spectranobins'</span>;
start      = <span class="string">'1970-01-01'</span>;
stop       = <span class="string">'1970-01-01T00:01:00'</span>;
opts       = struct(<span class="string">'logging'</span>,1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

<span class="comment">% Display information</span>
data
meta
fprintf(<span class="string">'meta.parameters = '</span>);
meta.parameters{:}

hapiplot(data,meta)
<span class="comment">% or</span>
<span class="comment">% hapiplot(data,meta,'spectranobins')</span>
</pre><pre class="codeoutput">Reading hapi-data/mag.gmu.edu_TestData_hapi/dataset1_spectranobins_19700101_19700101T000100.mat ... Done.

data = 

              Time: [60x23 char]
    DateTimeVector: [60x7 int32]
     spectranobins: [60x10 double]


meta = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:09'
     x_maxDurations: [1x1 struct]
            cadence: 'PT1S'
         parameters: {[1x1 struct]  [1x1 struct]}
               HAPI: '1.1'
             status: [1x1 struct]
                 x_: [1x1 struct]

meta.parameters = 
ans = 

      name: 'Time'
      type: 'isotime'
     units: 'UTC'
      fill: []
    length: 24


ans = 

           name: 'spectranobins'
           type: 'double'
          units: 'm'
           fill: '-1e31'
           size: 10
    description: 'A time independent 1/f spectra.'

hapiplot.m: Wrote ./hapi-figures/dataset1_spectranobins_19700101_19700101T000100.png
</pre><img vspace="5" hspace="5" src="hapi_demo_22.png" alt=""> <h2>Test Data: All parameters<a name="18"></a></h2><p>If parameters='', HAPI() get all parameters in the dataset and HAPIPLOT creates (one or more, as needed) plots for each individually. This demo works, but is suppressed.</p><pre class="codeinput">    <span class="keyword">if</span> (0)
    server     = <span class="string">'http://mag.gmu.edu/TestData/hapi'</span>;
    dataset    = <span class="string">'dataset1'</span>;
    parameters = <span class="string">''</span>;
    start      = <span class="string">'1970-01-01'</span>;
    stop       = <span class="string">'1970-01-01T00:01:00'</span>;
    opts       = struct(<span class="string">'logging'</span>,1);

    [data,meta] = hapi(server, dataset, parameters, start, stop, opts);

    data
    meta
    fprintf(<span class="string">'meta.parameters = '</span>);
    meta.parameters{:}

    hapiplot(data,meta)
<span class="keyword">end</span>
</pre><h2>Request list of known HAPI servers<a name="19"></a></h2><pre class="codeinput">Servers = hapi()
</pre><pre class="codeoutput">
Servers = 

    'http://datashop.elasticbeanstalk.com/hapi'
    'http://tsds.org/get/SSCWeb/hapi'
    'http://mag.gmu.edu/TestData/hapi'

</pre><h2>List datasets from a server<a name="20"></a></h2><pre class="codeinput">sn = 3; <span class="comment">% Server number of interest</span>
metad = hapi(Servers{sn})
<span class="comment">% or</span>
<span class="comment">% metad = hapi(Servers{sn},opts)</span>
</pre><pre class="codeoutput">See the interface at &lt;a href="http://tsds.org/get/#catalog=TestData"&gt;http://tsds.org/get/#catalog=TestData&lt;/a&gt;
to search and explore datasets from the &lt;a href="http://mag.gmu.edu/TestData/hapi"&gt;TestData&lt;/a&gt; HAPI Server.

metad = 

    catalog: {3x1 cell}
       HAPI: '1.1'
     status: [1x1 struct]

</pre><h2>Get metadata for all parameters in a dataset<a name="21"></a></h2><pre class="codeinput">dn = 1; <span class="comment">% Dataset number from server number sn</span>
metap = hapi(Servers{sn}, metad.catalog{dn}.id)
<span class="comment">% or</span>
<span class="comment">% metap = hapi(Servers{sn},ids{dn},opts);</span>
</pre><pre class="codeoutput">See the interface at &lt;a href="http://tsds.org/get/#catalog=TestData&amp;dataset=dataset0"&gt;http://tsds.org/get/#catalog=TestData&amp;dataset=dataset0&lt;/a&gt;
to search and explore parameters in this dataset from the &lt;a href="http://mag.gmu.edu/TestData/hapi"&gt;TestData&lt;/a&gt; HAPI Server.

metap = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:10'
            cadence: 'PT1M'
         parameters: {19x1 cell}

</pre><h2>Get parameter metadata for one parameter in a dataset<a name="22"></a></h2><pre class="codeinput">pn = 2; <span class="comment">% Parameter number pn in dataset dn from server sn</span>
metapr = hapi(Servers{sn}, metad.catalog{dn}.id, metap.parameters{pn}.name)
<span class="comment">% or</span>
<span class="comment">% metapr = hapi(Servers{sn}, metad.catalog{dn}.id, metap.parameters{pn}.name)</span>
</pre><pre class="codeoutput">Warning: Server returned too many parameters in
/info request 

data = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:10'
            cadence: 'PT1M'
         parameters: {[1x1 struct]  [1x1 struct]  [1x1 struct]}


metapr = 

          startDate: '1970-01-01'
           stopDate: '2016-12-31'
    sampleStartDate: '1970-01-01'
     sampleStopDate: '1970-01-01T00:00:10'
            cadence: 'PT1M'
         parameters: {[1x1 struct]  [1x1 struct]  [1x1 struct]}

</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Download hapi.m if not found.
% 
if exist('hapi','file') ~= 2
    u = 'https://raw.githubusercontent.com/hapi-server/matlab-client/master/hapi.m';
    urlwrite(u,'hapi.m');
end

%%  Scalar ephemeris from SSCWeb
%
server     = 'http://tsds.org/get/SSCWeb/hapi';
dataset    = 'ace';
parameters = 'X_TOD';
start      = '2012-02-01';
stop       = '2012-02-02';
opts       = struct('logging',1);

% Get data and metadata
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)

%% Two scalars from SSCWeb
% 
server     = 'http://tsds.org/get/SSCWeb/hapi';
dataset    = 'ace';
parameters = 'X_TOD,Y_TOD';
start      = '2012-02-01';
stop       = '2012-02-02';
opts       = struct('logging',1);

% Get data and metadata
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)

%% Scalar string from SSCWeb
%

server     = 'http://tsds.org/get/SSCWeb/hapi';
dataset    = 'ace';
parameters = 'LT_GEO';
start      = '2012-02-01';
stop       = '2012-02-02';
opts       = struct('logging',1);

% Get data and metadata
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)

%% Vector from CDAWeb
% Had to modify hapi.m to work because /info?id=AC_H0_MFI&parameters=BGSEc
% returns all parameters, not just BGSEc. Also note the metadata has
% the wrong fill value of "-9.999999848243207E30".  It should be "-1e31"
% and a correction was applied below.
server     = 'https://voyager.gsfc.nasa.gov/hapiproto/hapi';
dataset    = 'AC_H0_MFI';
parameters = 'BGSEc';
start      = '2002-01-01';
stop       = '2002-01-02';
opts       = struct('logging',1,'use_cache',0);

% Get data and metadata
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

meta.parameters{2}.fill = '-1e31'; % Correct fill value.
% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}
meta.parameters{1}.name = 'Time'; % Fix error in metadata.
% Plot
hapiplot(data,meta)

%% Jeremy's garage temperatures
% He is what we call, euphemistically, 'Temperature involved'.
% Note that hapi.m needed to allow 'float' as a data type
% for this to work.
server     = 'http://jfaden.net/HapiServerDemo/hapi';
dataset    = '0B000800408DD710';
parameters = '';
start      = '2017-06-17T21:20:32.052';
stop       = '2017-06-18T21:20:32.520';
opts       = struct('logging',1,'use_cache',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'0B000800408DD710')

%% Spectra from CASSINIA S/C
% HAPIPLOT infers that this should be plotted as a spectra because bins
% metadata were provided. Note that the first parameter is named
% time_array_0 instead of Time. To allow HAPIPLOT to work, this parameter
% was renamed before HAPIPLOT was called.  This parameter would have been
% plotted with log_{10} z-axis automatically by HAPIPLOT because the
% distribution of values is heavy-tailed, but there were negative values,
% which are not expected given the units are particles/sec/cm^2/ster/keV.
server     = 'http://datashop.elasticbeanstalk.com/hapi';
dataset    = 'CASSINI_LEMMS_PHA_CHANNEL_1_SEC';
parameters = 'A';
start      = '2002-01-01';
stop       = '2002-01-02T00:06:00';
opts       = struct('logging',1);

% Get data and metadata
[data,meta] = hapi(server,dataset,parameters,start,stop,opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}
meta.parameters{1}.name = 'Time'; % Fix error in metadata.
% Plot
hapiplot(data,meta)

%% Test Data: Vector (size = [3] in HAPI notation)
% HAPIPLOT infers that this a parameter that should be displayed as
% multiple time series because the number of components of the vector
% is < 10. Note that the metadata does not provide labels for the
% individual components of the vector, so "Column #" is used in the
% legend. HAPI metadata should include an option to add column labels.
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'vector';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)
% or
% hapiplot(data,meta,'vector')

%% Test Data: 10-element vector (size = [10] in HAPI notation)
% HAPIPLOT infers that this a parameter that should be displayed as
% a spectra because the number of vector elements is > 9. Note that the 
% metadata does not provide labels for the individual components of the
% vector, so "Column" is used as the y-axis label.
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'vector';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)
% or
% hapiplot(data,meta,'vector')

%% Test Data: 3x3 transformation matrix as 1-D HAPI array
% HAPIPLOT infers that this a parameter that should be displayed as
% a spectra because the number of components is >= 9. Note that the
% metadata does not provide bins so the y-labels are "Column #'.  In this
% case the data provider indented to provide a time series of rotation
% transformation matrices  (using Javascript array notation)
% [Txx, Txy, Txz, Tyx, Tyy, Tyz, Tzx, Tzy, Tzz]. HAPI metadata should 
% include the ability to provide these labels.
server     = 'http://mag.gmu.edu/TestData/hapi';
dataset    = 'dataset1';
parameters = 'transform';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)
% or
% hapiplot(data,meta,'transform')

%% Test Data: 3x3 transformation matrix as 2-D HAPI array
% HAPIPLOT displays each layer of the matrix as three time series with
% y-labels tranformmulti(:,:,1), transformmulti(:,:,2), and
% transformmulti(:,:,3) and legend labels of "Column #", where # = 1, 2, or
% 3. In this case the data provided intended to provided a time series of
% rotation matrices with labels (using HAPI array notation)
% [['Txx','Txy','Txz'],['Tyx','Tyy','Tyz'],['Tzx','Tzy','Tzz']]. HAPI
% should include the ability to provide these labels.
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'transformmulti';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

% Plot
hapiplot(data,meta)
% or
% hapiplot(data,meta,'transformulti')

%% Test Data: Scalar string parameter
% Demonstrating how HAPIPLOT handles this type of parameter.
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'scalarstr';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'scalarstr')

%% Test Data: Scalar isotime parameter
% HAPIPLOT converts the isotime string to a MATLAB DATENUM to create
% y-axis labels.
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'scalariso';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'scalariso')

%% Test Data: Scalar integer parameter (with proposed category map)
% A time series of integers intended to communicate a status represented by
% a string.  The metadata includes a (non-HAPI standard) map from an
% integer to a string, and this map is used to generate y-axis labels.
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'scalarcats';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'scalarcats')

%% Test Data: Parameter that is two vectors
% HAPIPLOT creates two time series plots in this case and labels the first
% using MATLAB notation as vectormulti(:,:,1) and second as
% vectormulti(:,:,2).
server     = 'http://mag.gmu.edu/TestData/hapi'; ;
dataset    = 'dataset1';
parameters = 'vectormulti';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'vectormulti')

%% Test Data: Vector of strings
% In this unusual dataset, 3-vector (size = [3] in HAPI notation) of
% strings is given. HAPIPLOT creates three time series plots, one for each
% vector component.
server     = 'http://mag.gmu.edu/TestData/hapi';
dataset    = 'dataset1';
parameters = 'vectorstr';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'vectorstr')

%% Test Data: 100-element time series with no bins
% HAPIPLOT assumes that this is best plotted as a spectra because
% the number of elements is greater than 9.
server     = 'http://mag.gmu.edu/TestData/hapi';
dataset    = 'dataset1';
parameters = 'spectranobins';
start      = '1970-01-01';
stop       = '1970-01-01T00:01:00';
opts       = struct('logging',1);

[data,meta] = hapi(server, dataset, parameters, start, stop, opts);

% Display information
data
meta
fprintf('meta.parameters = ');
meta.parameters{:}

hapiplot(data,meta)
% or
% hapiplot(data,meta,'spectranobins')

%% Test Data: All parameters
% If parameters='', HAPI() get all parameters in the dataset and HAPIPLOT
% creates (one or more, as needed) plots for each individually. This demo
% works, but is suppressed.
    if (0)
    server     = 'http://mag.gmu.edu/TestData/hapi';
    dataset    = 'dataset1';
    parameters = '';
    start      = '1970-01-01';
    stop       = '1970-01-01T00:01:00';
    opts       = struct('logging',1);

    [data,meta] = hapi(server, dataset, parameters, start, stop, opts);

    data
    meta
    fprintf('meta.parameters = ');
    meta.parameters{:}

    hapiplot(data,meta)
end

%% Request list of known HAPI servers
% 
Servers = hapi()

%% List datasets from a server
% 
sn = 3; % Server number of interest
metad = hapi(Servers{sn})
% or 
% metad = hapi(Servers{sn},opts)

%% Get metadata for all parameters in a dataset 
%
dn = 1; % Dataset number from server number sn
metap = hapi(Servers{sn}, metad.catalog{dn}.id)
% or
% metap = hapi(Servers{sn},ids{dn},opts);

%% Get parameter metadata for one parameter in a dataset
%
pn = 2; % Parameter number pn in dataset dn from server sn
metapr = hapi(Servers{sn}, metad.catalog{dn}.id, metap.parameters{pn}.name)
% or
% metapr = hapi(Servers{sn}, metad.catalog{dn}.id, metap.parameters{pn}.name)
##### SOURCE END #####
--></body></html>